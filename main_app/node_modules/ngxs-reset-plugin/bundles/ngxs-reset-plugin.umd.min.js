!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@ngxs/store"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngxs-reset-plugin",["exports","@angular/core","@ngxs/store","rxjs/operators"],t):t((e=e||self)["ngxs-reset-plugin"]={},e.ng.core,e.store,e.rxjs.operators)}(this,function(e,t,r,n){"use strict";var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(i){o={error:i}}finally{try{n&&!n.done&&(r=a["return"])&&r.call(a)}finally{if(o)throw o.error}}return s}function s(){return function(){}}var i=function(){function e(){}return e.decorators=[{type:t.Injectable}],e}(),u=function(){function e(e,t,a){var s=this;this.actions$=e,this.store=t,this.resetService=a,this.actions$.pipe(r.ofActionSuccessful(r.InitState),n.take(1)).subscribe(function(){return s.resetService.initialState=s.store.snapshot()}),this.actions$.pipe(r.ofActionSuccessful(r.UpdateState)).subscribe(function(e){var t=e.addedStates;return s.resetService.initialState=o({},s.resetService.initialState,t)})}return e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:r.Actions},{type:r.Store},{type:i}]},e}(),c=function(){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=d(t.isDevMode());this.statesToKeep=e.reduce(n,[])}return e.type="@@CLEAR_STATE",e}(),f=function(){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=d(t.isDevMode());this.statesToReset=e.reduce(n,[])}return e.type="@@RESET_STATE",e}(),l=function(){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=d(t.isDevMode());this.statesToKeep=e.reduce(n,[])}return e.type="@@RESET_STATE_ALL",e}(),p=function(){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n,o=(n=t.isDevMode(),function(e,t){var r=a(t,2),o=r[0],s=r[1],i=v(o,~n);return i?[e[0].concat(i),e[1].concat(s)]:e}),s=a(e.reduce(o,[[],[]]),2),i=s[0],u=s[1];this.statesToOverwrite=i,this.values=u}return e.type="@@OVERWRITE_STATE",e}();function v(e,t){var n=new Object(r.getStoreMetadata(e));return n.name&&"defaults"in n||-2!==t?n:(console.warn("Reset Plugin Warning: "+n.name+" is not a state class."),null)}function d(e){return function(t,r){var n=v(r,~e);return n?t.concat(n):t}}var S=function(){function e(e){this.resetService=e}return e.prototype.clearStates=function(e,t){return t.map(function(e){return h(e)}).map(function(t){return{parts:t.split("."),value:r.getValue(e,t)}}).reduce(function(e,t){var r=t.parts,n=t.value;return r.reduceRight(function(t,r){var n,a;return r in e?((n={})[r]=o({},e[r],t),n):((a={})[r]=t,a)},n)},{})},e.prototype.overwriteStates=function(e,t,n){return t.forEach(function(t,o){return e=r.setValue(e,h(t),n[o])}),e},e.prototype.resetStates=function(e,t){var n=this;return t.forEach(function(t){e=r.setValue(e,h(t),"undefined"==typeof t.defaults?{}:t.defaults),t.children&&(e=n.resetStates(e,t.children.map(v)))}),e},e.prototype.resetStatesAll=function(e,t){var n=t.map(function(t){return r.getValue(e,h(t))});return this.overwriteStates(this.resetService.initialState,t,n)},e.prototype.handle=function(e,t,n){switch(r.getActionTypeFromInstance(t)){case c.type:e=this.clearStates(e,t.statesToKeep);break;case f.type:e=this.resetStates(e,t.statesToReset);break;case l.type:e=this.resetStatesAll(e,t.statesToKeep);break;case p.type:var o=t,a=o.statesToOverwrite,s=o.values;e=this.overwriteStates(e,a,s)}return n(e,t)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:i}]},e}();function h(e){return e.path}var y=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[i,u,{provide:t.APP_INITIALIZER,useFactory:s,deps:[u],multi:!0},{provide:r.NGXS_PLUGINS,useClass:S,multi:!0}]}},e.decorators=[{type:t.NgModule}],e}();e.NgxsResetPlugin=S,e.NgxsResetPluginModule=y,e.StateClear=c,e.StateOverwrite=p,e.StateReset=f,e.StateResetAll=l,e.getMetaData=v,e.ɵa=i,e.ɵb=u,e.ɵd=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngxs-reset-plugin.umd.min.js.map